# Telegram Bot для конференции "Менеджмент Будущего 2025"

Это telegram-бот для участников конференции, который предоставляет информацию о расписании, регистрацию на сессии, навигацию и FAQ.

## Технологический стек

- **Python 3.11+**
- **aiogram 3.11.0+** - библиотека для создания Telegram ботов
- **aiogram_dialog 2.2.0+** - расширение для создания диалогов
- **PostgreSQL** - база данных для хранения информации
- **Redis** - кеширование и хранение состояний FSM
- **environs** - работа с переменными окружения

## Структура проекта

```
MB-bots_participants/
├── config/
│   └── config.py          # Конфигурация приложения
├── app/
│   ├── bot/
│   │   ├── states/        # FSM состояния
│   │   ├── dialogs/       # Диалоги aiogram_dialog
│   │   ├── handlers/      # Обработчики сообщений
│   │   ├── middlewares/   # Middleware компоненты
│   │   └── bot.py         # Основной файл бота
│   └── infrastructure/    # Инфраструктурные компоненты
├── main.py               # Точка входа
├── config.json          # Настройки конференции
├── timetable.json       # Расписание мероприятий
├── .env                 # Переменные окружения
└── requirements.txt     # Зависимости Python
```

## Установка и настройка

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Настройка переменных окружения

Скопируйте `.env.example` в `.env` и заполните необходимые значения:

```bash
cp .env.example .env
```

Отредактируйте `.env`:
```env
BOT_TOKEN=your_bot_token_here
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=conference_bot
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=redis_password
```

### 3. Настройка конфигурации конференции

Отредактируйте `config.json`:
```json
{
  "start_date": "2025-10-01"
}
```

### 4. Настройка расписания

Отредактируйте `timetable.json`, добавив мероприятия:
```json
[
  {
    "title": "Название мероприятия",
    "description": "Описание мероприятия",
    "location": "Место проведения",
    "start_date": "2025-10-01",
    "start_time": "09:00",
    "end_date": "2025-10-01",
    "end_time": "10:00"
  }
]
```

### 5. Запуск PostgreSQL и Redis

Убедитесь, что PostgreSQL и Redis запущены и доступны по указанным в `.env` адресам.

### 6. Запуск бота

```bash
python main.py
```

## Функциональность

### Основные диалоги

1. **Стартовый диалог** - приветствие и переход в главное меню
2. **Главное меню** - навигация по основным разделам
3. **Расписание** - просмотр мероприятий по дням
4. **Регистрация на сессии** - (в разработке)
5. **Навигация** - помощь в навигации по площадке (в разработке)
6. **FAQ** - часто задаваемые вопросы (в разработке)

### Диалог расписания

- Автоматическое группирование мероприятий по дням (День 0-4)
- Отображение только дней с мероприятиями
- Список событий с временем и местом проведения
- Детальная информация о каждом мероприятии

## Структура диалогов

### Диалог Start
```
Окно 1: Приветствие
└── Кнопка: "В главное меню" → переход в main_menu
```

### Диалог Main Menu
```
Окно 1: Главное меню
├── Кнопка: "Расписание" → переход в timetable
├── Кнопка: "Регистрация на сессии" → переход в registration
├── Кнопка: "Навигация" → переход в navigation
└── Кнопка: "FAQ" → переход в faq
```

### Диалог Timetable
```
Окно 1: Список дней
├── Кнопки: "День 0", "День 1", etc.
│
Окно 2: События дня
├── Текст: расписание в формате "Время-Время – Название (место)"
├── Кнопки: названия мероприятий
└── Кнопка: "Назад"
│
Окно 3: Детали мероприятия
├── Текст: подробная информация
└── Кнопка: "Назад"
```

## Конфигурация

### Config.json
- `start_date` - дата начала конференции в формате YYYY-MM-DD

### Timetable.json
Массив объектов мероприятий со следующими полями:
- `title` - название
- `description` - описание
- `location` - место проведения
- `start_date` - дата начала (YYYY-MM-DD)
- `start_time` - время начала (HH:MM)
- `end_date` - дата окончания (YYYY-MM-DD)
- `end_time` - время окончания (HH:MM)

## Разработка

### Добавление новых диалогов

1. Создайте состояния в `app/bot/states/`
2. Создайте диалог в `app/bot/dialogs/`
3. Подключите диалог в `app/bot/bot.py`

### Добавление новых функций

1. Создайте необходимые обработчики в `app/bot/handlers/`
2. Подключите роутеры в `app/bot/bot.py`

## Логирование

Логи записываются в:
- Консоль (уровень INFO и выше)
- Файл `bot.log` (уровень INFO и выше)

## Безопасность

- Все чувствительные данные хранятся в `.env`
- Используется middleware для обработки ошибок
- Настроена валидация входных данных
